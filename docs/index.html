<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Client-side CryptoShield encrypt/decrypt for CSP1 tokens. No server, no upload."
    />

    <!-- Hardening only (does not hide source code) -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self';
               script-src 'self';
               style-src 'self';
               img-src 'self' data:;
               base-uri 'none';
               object-src 'none';
               connect-src 'none'"
    />

    <title>CryptoShield Web</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <main class="page">
      <section class="panel" aria-label="CryptoShield Web">
        <header class="hero">
          <div>
            <div class="brand">CryptoShield</div>
            <div class="tag">Web Encrypt / Decrypt</div>
          </div>

          <div class="header-actions">
            <button id="about-open" class="ghost small" type="button">About</button>

            <div class="theme-toggle" role="group" aria-label="Theme">
              <button class="theme-btn active" data-theme="light" type="button">Light</button>
              <button class="theme-btn" data-theme="dark" type="button">Dark</button>
            </div>
          </div>
        </header>

        <p class="lede">
          Encrypt or decrypt CryptoShield text tokens in your browser. No server, no upload.
        </p>

        <div class="watermark" aria-hidden="true">Licensed for use on this page only</div>

        <div class="tab-bar" role="tablist" aria-label="Mode">
          <button class="tab active" data-tab="encrypt" role="tab" aria-selected="true">Encrypt</button>
          <button class="tab" data-tab="decrypt" role="tab" aria-selected="false">Decrypt</button>
        </div>

        <!-- Decrypt -->
        <div id="tab-decrypt" class="grid tab-panel" hidden>
          <div class="field">
            <label for="passphrase-decrypt">Passphrase</label>
            <div class="input-row">
              <input id="passphrase-decrypt" type="password" placeholder="Enter passphrase" autocomplete="current-password" />
              <button class="toggle-pass" type="button" data-target="passphrase-decrypt">Show</button>
            </div>
          </div>

          <div class="field full">
            <label for="token">Encrypted Token</label>
            <textarea id="token" rows="6" placeholder="Paste the CryptoShield token here"></textarea>
          </div>

          <div class="actions full">
            <button id="decrypt" class="primary" type="button">Decrypt</button>
            <button id="copy" class="ghost" type="button">Copy Output</button>
            <button id="clear" class="ghost" type="button">Clear</button>
          </div>

          <div class="field full">
            <label for="output">Plaintext</label>
            <textarea id="output" rows="6" placeholder="Decrypted text appears here" readonly></textarea>
          </div>

          <div id="status" class="status full">Ready.</div>
        </div>

        <!-- Encrypt -->
        <div id="tab-encrypt" class="grid tab-panel active">
          <div class="field">
            <label for="passphrase-encrypt">Passphrase</label>
            <div class="input-row">
              <input id="passphrase-encrypt" type="password" placeholder="Enter passphrase" autocomplete="new-password" />
              <button class="toggle-pass" type="button" data-target="passphrase-encrypt">Show</button>
            </div>
          </div>

          <div class="field full">
            <label for="plaintext">Plaintext</label>
            <textarea id="plaintext" rows="6" placeholder="Type your message here"></textarea>
          </div>

          <div class="actions full">
            <button id="encrypt" class="primary" type="button">Encrypt</button>
            <button id="copy-encrypt" class="ghost" type="button">Copy Token</button>
            <button id="clear-encrypt" class="ghost" type="button">Clear</button>
          </div>

          <div class="field full">
            <label for="token-out">Encrypted Token</label>
            <textarea id="token-out" rows="6" placeholder="Encrypted token appears here" readonly></textarea>
          </div>

          <div id="status-encrypt" class="status full">Ready.</div>
        </div>

        <details class="help">
          <summary>Format details</summary>
          <p>
            Format: <code>base64url("CSP1" + 16-byte salt + fernet_token_bytes)</code>.
            KDF: PBKDF2-HMAC-SHA256 (<strong>200,000</strong> iters).
            Fernet: AES-128-CBC + HMAC-SHA256.
          </p>
        </details>

        <footer class="legal">
          <div class="legal-title">⚠️ Proprietary Software Notice</div>
          <p>This tool is provided for use exclusively through this webpage.</p>
          <p>Copying, inspecting, reusing, or redistributing the source code is prohibited by license.</p>
          <p>© 2025 Chanitha. All rights reserved.</p>
        </footer>
      </section>
    </main>

    <!-- About modal -->
    <div id="modal-about" class="modal-backdrop" hidden>
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="about-title">
        <div class="modal-head">
          <h3 id="about-title">About</h3>
          <button id="about-close" class="ghost small" type="button">Close</button>
        </div>
        <p>CryptoShield Web is a client-side encrypt/decrypt tool.</p>
        <p class="muted">Nothing is uploaded. All processing happens in your browser.</p>
      </div>
    </div>

    <!-- Domain lock modal (deterrent only) -->
    <div id="origin-lock" class="modal-backdrop" hidden>
      <div class="modal warning" role="dialog" aria-modal="true" aria-labelledby="origin-title">
        <div class="modal-head">
          <h3 id="origin-title">Unlicensed Domain</h3>
        </div>
        <p>This tool is licensed for use on its official domain only.</p>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>